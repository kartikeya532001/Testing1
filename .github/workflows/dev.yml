name: Build and Release Web + Android

on:
  push:
    branches: [main]

jobs:
  hosting:
    name: Deploy Web and Android
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Install Shorebird CLI (Manual)
        run: |
          mkdir -p $HOME/.shorebird/bin
          curl -L "https://api.shorebird.dev/download/latest/linux-x64" -o $HOME/.shorebird/bin/shorebird
          ls
          chmod +x $HOME/.shorebird/bin/shorebird
      
          # Validate installation
          if [ -x "$HOME/.shorebird/bin/shorebird" ]; then
            echo "✅ Shorebird CLI downloaded successfully."
          else
            echo "❌ Shorebird CLI download failed."
            exit 1
          fi
      
          echo "$HOME/.shorebird/bin" >> $GITHUB_PATH
          echo "export PATH=$HOME/.shorebird/bin:$PATH" >> $GITHUB_ENV
          export PATH="$HOME/.shorebird/bin:$PATH"
          shorebird --version



      - name: Shorebird Login
        run: |
            "$HOME/.shorebird/shorebird" login --auth-token ${{ secrets.SHOREBIRD_AUTH_TOKEN }}
